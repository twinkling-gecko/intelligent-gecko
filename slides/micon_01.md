---
marp: true
theme: moja-gecko
---

<!--- _class: cover -->

# マイコン勉強会 1 電子回路編

## Team: twinkling-gecko<br>Version: 1.1

---

# この会の目標

- マイコンを触る上で必要になる電子工作周りの話になんとなく慣れておく
- 正しく完全に理解するわけではない

![image](https://i.gyazo.com/thumb/400/19d9c5d8e9b1bddf2a073aa42e57da09-png.png)

---

# 全体の流れ

- 電子工作の基礎色々
- 電気通信について
- シリアル通信について

---

# 電圧の話

- ある 2 点間の電位の差
- よく水の流れる勢いに例えられる (厳密には違うけど)

![image](https://hegtel.com/wp/wp-content/uploads/2018/02/shot_181217_094432.jpg)

- 昔ながらの水鉄砲に例えて、ピストンを押す力が電圧
  - 強く押せば水が強く、量も沢山出る

---

# よく目にする電圧

- 1.5V
  - 乾電池
- **3.3V**
  - 集積回路・GPIO
  - パソコンの 4pin ペリフェラル電源
- 3.7V
  - Li-Po バッテリー
    - スマホ・タブレット・モバイルバッテリー・etc...
- **5V**
  - USB・集積回路・GPIO

---

# よく目にする電圧

- 9V
  - 角型電池(四角いアレ)
- 12V
  - 3.5inch HDD
  - 車の電装系 (シガーソケットとか)
- 100V
  - 日本の家庭用電源

<!-- 12V、篠原くんの腕が上がらなくなるやつ -->

---

# 直流・交流

## 直流

- プラスとマイナスが一定(時間によって変化しない)
- 大体の電子機器とかバッテリーはこっち
- 電話線だと、DC-48V が流れてる

## 交流

- 時間によってプラスとマイナスが入れ替わる(時間によって変化する)
- 電圧の変更が用意で、送電するには都合が良い
- 家庭用電源(コンセント)はこっち

---

# 電流の話

- 電荷の移動量
- よく水の量に例えられる

![image](https://hegtel.com/wp/wp-content/uploads/2018/02/shot_181217_094432.jpg)

- 昔ながらの水鉄砲に例えて、出てる水の量が電流

- 電圧 x 電流 = 電力(仕事量)
  - V x A = W

<!-- 5V1Aで5Wとか -->

---

# 抵抗について

![bg 30%](https://pbs.twimg.com/media/CkQLSYXVAAAowS0.jpg)

- 電流の流れにくさを
  表した値のこと
- 単位はオーム(Ω)
- 物体によって、同じ電圧
  をかけても、電流が 1A
  しか流れなかったり、
  2A 流れたりする
- オームの法則で欲しい
  パラメータを求められる
  - 電圧 = 抵抗 \* 電流

<!-- 抵抗器で調整して、先の回路に必要な電流を与えたり出来る -->

---

# アナログ信号とデジタル信号

- アナログは連続的な値をそのまま表現出来る

  - 最小から最大までの間で、無段階に好きな値を取れる
  - ノイズに弱い

- デジタルは bool でしか表現できない
  - True or False
  - 0,1 のパターンに意味を持たせて、データとして表現する
    - サンプリングによってアナログに近い形の
      連続的な値の表現もできる
  - ノイズに強い

---

# PWM について

- デジタルしか扱えないハードでアナログを表現する
- 0 と 1 しか使えないなら、0 と 1 を超高速でオンオフすれば 0.3 とか 0.6 っぽく見えるんじゃねってやつ
- モーター制御とか LED の輝度とかで使ったりする
  - オンかオフしか出来ないモーターの速度調整
  - デジタルピンから LED の輝度調整
- オンの時間が長ければ(デューティ比が大きければ)1 に近づき、
  短ければ(デューティ比が小さければ)0 に近づく

<!-- ケトルはポットと違って温調保温機能が無い(1回1回沸かす為のものだから) -->
<!-- このケトルでラーメンを茹でる際に、吹きこぼれることのない火力を維持したい場合 -->
<!-- 電源オンオフを高速で繰り返すことで、擬似的に弱火にできる -->

---

# シリアルとパラレル

- あるデータを送るのに、直列で送るか、並列で送るか
- 一見並列で送ったほうが早そうに見えるが、実際には色々と問題があり、直列の方が早かったりする
  - 各線の同期が取れない
  - 各線の信号がノイズとなって他の線に影響する (クロストーク)
- パラレルのバスを扱うことはほぼないと思う

---

# GPIO

- General-purpose input/output
  - 汎用入出力
  - 動作を切り替えられる
    - 1 つのピンを入力にも出力にも使える

---

# シリアル通信

- 先程あげたシリアルとパラレルのうち、シリアルで通信するもの
  - パラレル通信もある
- U**S**B とか **S**ATA とか Ethernet とか PCIe とかも普通にシリアル通信といえばそう
  - こいつらは規格としてめちゃくちゃ複雑だけど
- ここでは、組み込み界隈で良く使われる意味でのシリアル通信を扱う
- 以後の説明に必要なので、まずボーのお話をします

---

# ボー

- ボーレートと言ったりする
- シリアル通信的には、bps と同義
- 本来の意味だと、1 秒間に何回変調を行うことが出来るか
- 1 秒間に 300 回の変調が出来れば、300 ボーとなる
- シリアル通信では１回に 1 ビット転送するので、bps で表現されたりする
- 言葉の使い方としては、「Arduino Leonardo に対して
  1200 ボーでシリアル接続して閉じるとリセットされる」みたいな感じ
- 送信機器も受信機器も、このレートでデータのやり取りをすると
  認識する
- 運用する上では、**機器間でボーレートが違うと文字化けしたりする**
  (データが壊れてしまう)

<!-- 変調:情報を電気信号や電波や光などの信号として表現すること -->

---

# シリアル通信

## よく使われるシリアル通信

- RS232C

  - 最も広く使われるシリアル通信規格
  - 組み込み機器とか NW 機器のコンソールアクセス
    手段として今でも使われる
  - 物理的なインタフェースは絶滅したので、USB のコネクタで
    RS232C の通信を行う USB - シリアル変換をするチップとかも
    広く出回っている
  - **調歩同期(非同期, async)で、通信機器同士はクロック信号の
    やり取りを行わず、自身のボーでタイミングを取る**

<!-- USBは規格としてめちゃくちゃ複雑なので、変換チップを使ってRS232Cで通信するのがよくある -->

---

# シリアル通信

## よく使われるシリアル通信

- UART
  - マイコンやボード上のシリアル通信で広く使われる
  - ルーター分解すると基板に実装されてたりする
  - TX(送信) RX(受信) GND(グランド)の 3 線を利用
  - こちらも調歩同期(async)
    - USART として同期式に対応した別の規格もある

<!-- VCCは直接UARTとは関係無い気もするので外した -->

---

# シリアル通信

## よく使われるシリアル通信

- SPI
  - Motorola が提唱
  - 3 本または 4 本の線で構成され、数 Mbps での通信が可能
    - 50Mbps 位が限界
  - マスター/スレーブが存在
  - 同期式のシリアル通信
    - **クロック信号をやり取りし、同期しながら通信を行う**

---

# シリアル通信

## よく使われるシリアル通信

- I2C

  - Philips が提唱
  - **2 本の接続線**で構成され、1Mbps 位までの通信が可能
  - 転送レートは SPI に劣るが、**接続線が少なくて済む コストも安い**
  - マスター/スレーブが存在
  - 同期式のシリアル通信
    - クロック信号をやり取りし、同期しながら通信を行う
  - Wii リモコンとヌンチャクの通信で使われてるらしい

<!-- <http://www.picfun.com> -->
<!--
このサイト書いてあることがめちゃくちゃだった
1つのマスターに対し複数スレーブがI2Cの特徴の様に書いたり
I2Cが高速だと書いたり
 -->

---

<!-- _class: back-cover -->

# Just Do it!

![bg 50%](https://stat.ameba.jp/user_images/20180314/08/w3t6t2pmaj/1c/b5/j/o0708052814149196385.jpg)
